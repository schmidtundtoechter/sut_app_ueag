[
    {
        "name": "Mitarbeiter - Berechne Wochenarbeitszeit bei In Verhandlung plus alte Werte",
        "idx": 3,
        "script_type": "DocType Event",
        "reference_doctype": "Employee",
        "event_frequency": "All",
        "cron_format": null,
        "doctype_event": "Before Save",
        "api_method": null,
        "allow_guest": 0,
        "module": "Custom",
        "disabled": 0,
        "script": "# Dieses Script wird beim Speichern eines Employee-Dokuments ausgef\u00fchrt.\r\n# Dieses Script wurde von Lars Maeurer bearbeitet und sollte funktionieren. Tests stehen teilweise noch aus.\r\n\r\ndef calculate_working_hours(doc):\r\n    # Variableninitialisierung\r\n    SUMMEGRUNDVERTRAGWAZ = 0\r\n    SUMMEPROJEKT1WAZ = 0\r\n    SUMMEPROJEKT2WAZ = 0\r\n    SUMMEPROJEKT3WAZ = 0\r\n    SUMMEPROJEKT4WAZ = 0\r\n    SUMMEZULAGEWAZ = 0\r\n    custom_summe_wochenarbeitszeit = 0\r\n\r\n    today_date = frappe.utils.getdate()  # Wandelt das heutige Datum in ein Date-Objekt um\r\n    \r\n    # Erster Teil: Grundvertrag pr\u00fcfen\r\n    if doc.custom_grundvertrag_in_verhandlung:\r\n        if (doc.custom_wochenstunden_grundvertrag_in_verhandlung\r\n            and (not doc.custom_start_des_grundvertrags_in_verhandlung or today_date >= frappe.utils.getdate(doc.custom_start_des_grundvertrags_in_verhandlung))\r\n            and (not doc.custom_ende_des_arbeitsverh\u00e4ltnis_in_verhandlung or today_date <= frappe.utils.getdate(doc.custom_ende_des_arbeitsverh\u00e4ltnis_in_verhandlung))):\r\n            SUMMEGRUNDVERTRAGWAZ = doc.custom_wochenstunden_grundvertrag_in_verhandlung\r\n    else:\r\n        if (doc.custom_wochenstunden_grundvertrag \r\n            and (not doc.custom_start_des_grundvertrags or today_date >= frappe.utils.getdate(doc.custom_start_des_grundvertrags))\r\n            and (not doc.custom_ende_des_arbeitsverh\u00e4ltnis or today_date <= frappe.utils.getdate(doc.custom_ende_des_arbeitsverh\u00e4ltnis))):\r\n            SUMMEGRUNDVERTRAGWAZ = doc.custom_wochenstunden_grundvertrag\r\n\r\n    # Zweiter Teil: Projektvertr\u00e4ge pr\u00fcfen\r\n    if doc.custom_projekt_1_in_verhandlung:\r\n        if doc.custom_wochenstunden_projekt_1_iv and doc.custom_wochenstunden_projekt_1_iv > 0:\r\n            SUMMEPROJEKT1WAZ = doc.custom_wochenstunden_projekt_1_iv\r\n    else:\r\n        if doc.custom_wochenstunden_projekt_1 and (not doc.custom_start_der_1_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_1_arbeit)) \\\r\n            and (not doc.custom_befristung_des_1_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_1_vertrags)):\r\n            SUMMEPROJEKT1WAZ = doc.custom_wochenstunden_projekt_1\r\n\r\n    if doc.custom_projekt_2_in_verhandlung:\r\n        if doc.custom_wochenstunden_projekt_2_iv and doc.custom_wochenstunden_projekt_2_iv > 0:\r\n            SUMMEPROJEKT2WAZ = doc.custom_wochenstunden_projekt_2_iv\r\n    else:\r\n        if doc.custom_wochenstunden_projekt_2 and (not doc.custom_start_der_2_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_2_arbeit)) \\\r\n            and (not doc.custom_befristung_des_2_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_2_vertrags)):\r\n            SUMMEPROJEKT2WAZ = doc.custom_wochenstunden_projekt_2\r\n\r\n    if doc.custom_projekt_3_in_verhandlung:\r\n        if doc.custom_wochenstunden_projekt_3_iv and doc.custom_wochenstunden_projekt_3_iv > 0:\r\n            SUMMEPROJEKT3WAZ = doc.custom_wochenstunden_projekt_3_iv\r\n    else:\r\n        if doc.custom_wochenstunden_projekt_3 and (not doc.custom_start_der_3_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_3_arbeit)) \\\r\n            and (not doc.custom_befristung_des_3_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_3_vertrags)):\r\n            SUMMEPROJEKT3WAZ = doc.custom_wochenstunden_projekt_3\r\n\r\n    if doc.custom_wochenstunden_projekt_4 and (not doc.custom_start_der_4_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_4_arbeit)) \\\r\n        and (not doc.custom_befristung_des_4_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_4_vertrags)):\r\n        SUMMEPROJEKT4WAZ = doc.custom_wochenstunden_projekt_4\r\n\r\n    # Dritter Teil: Arbeitszeiten zusammenrechnen\r\n    projekt_sum = SUMMEPROJEKT1WAZ + SUMMEPROJEKT2WAZ + SUMMEPROJEKT3WAZ + SUMMEPROJEKT4WAZ\r\n    if projekt_sum == 0: custom_summe_wochenarbeitszeit = SUMMEGRUNDVERTRAGWAZ\r\n\r\n    # Welche Kreuze spielen eine Rolle?\r\n    if doc.custom_projekt_1_in_verhandlung: kreuz1 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_iv\r\n    else: kreuz1 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt    \r\n    if doc.custom_projekt_2_in_verhandlung: kreuz2 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2_iv\r\n    else: kreuz2 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2    \r\n    if doc.custom_projekt_3_in_verhandlung: kreuz3 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3_iv\r\n    else: kreuz3 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3   \r\n    # Das 4. Projekt hat keine Verhandlungsoption \r\n    kreuz4 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_4\r\n\r\n    if projekt_sum > 0 and (not any([kreuz1,kreuz2,kreuz3,kreuz4])): \r\n        custom_summe_wochenarbeitszeit = projekt_sum\r\n    else:\r\n        custom_summe_wochenarbeitszeit = projekt_sum + SUMMEGRUNDVERTRAGWAZ\r\n\r\n    # Vierter Teil: Zulagen summieren und hinzuf\u00fcgen\r\n    if doc.custom_zulage_1_in_verhandlung:\r\n        if ((doc.custom_projekt_zulage_1_iv and doc.custom_wochenstunden_zulage_1_iv)\r\n            and (not doc.custom_anfangsdatum_zulage_1_iv or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_1_iv))\r\n            and (not doc.custom_enddatum_zulage_1_iv or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_1_iv))):\r\n            SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + doc.custom_wochenstunden_zulage_1_iv\r\n    else:\r\n        if ((doc.custom_projekt_zulage_1 and doc.custom_wochenstunden_zulage_1)\r\n            and (not doc.custom_anfangsdatum_zulage_1 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_1))\r\n            and (not doc.custom_enddatum_zulage_1 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_1))):\r\n            SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + doc.custom_wochenstunden_zulage_1\r\n\r\n    if doc.custom_zulage_2_in_verhandlung:\r\n        if ((doc.custom_projekt_zulage_2_iv and doc.custom_wochenstunden_zulage_2_iv)\r\n            and (not doc.custom_anfangsdatum_zulage_2_iv or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_2_iv))\r\n            and (not doc.custom_enddatum_zulage_2_iv or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_2_iv))):\r\n            SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + doc.custom_wochenstunden_zulage_2_iv\r\n    else:\r\n        if ((doc.custom_projekt_zulage_2 and doc.custom_wochenstunden_zulage_2)\r\n            and (not doc.custom_anfangsdatum_zulage_2 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_2))\r\n            and (not doc.custom_enddatum_zulage_2 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_2))):\r\n            SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + doc.custom_wochenstunden_zulage_2\r\n\r\n    if custom_summe_wochenarbeitszeit > 0:\r\n        custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEZULAGEWAZ\r\n\r\n    # Ergebnis speichern\r\n    doc.custom_summe_wochenarbeitszeit__bei_offener_vertragsverhandlung = custom_summe_wochenarbeitszeit\r\n    #doc.custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit\r\n    #doc.custom_summe_wochenarbeitszeit_2 = custom_summe_wochenarbeitszeit\r\n\r\n# Funktion wird bei Speichern aufgerufen\r\ncalculate_working_hours(doc)\r\n\r\n",
        "enable_rate_limit": 0,
        "rate_limit_count": 5,
        "rate_limit_seconds": 86400,
        "_user_tags": null,
        "_comments": "[{\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>Logik: Vor dem Speichern werden die Wochenstunden in Summe ne...\", \"by\": \"Administrator\", \"name\": \"v6vmmhh0qi\"}, {\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><h3><strong>Funktionsweise des Scripts</strong></h3><p>Das Scrip...\", \"by\": \"Administrator\", \"name\": \"ehinjqm6k3\"}]",
        "_assign": null,
        "_liked_by": "[\"l.maeurer@schmidtundtoechter.com\"]",
        "doctype": "Server Script"
    },
    {
        "name": "Mitarbeiter - Gesamtlohn des gerade bearbeiteten MA incl. Vertragsverhandlung berechnen",
        "idx": 2,
        "script_type": "DocType Event",
        "reference_doctype": "Employee",
        "event_frequency": "All",
        "cron_format": null,
        "doctype_event": "Before Save",
        "api_method": null,
        "allow_guest": 0,
        "module": "Custom",
        "disabled": 0,
        "script": "# Dieses Script wird beim Speichern eines Employee-Dokuments ausgef\u00fchrt.\r\n# Dieses Script wurde von Lars Maeurer bearbeitet und sollte funktionieren. Tests stehen teilweise noch aus.\r\n\r\ndef calculate_salary(doc):\r\n    # Variableninitialisierung\r\n    SUMMEGRUNDVERTRAG = 0\r\n    SUMMEPROJEKT1 = 0\r\n    SUMMEPROJEKT2 = 0\r\n    SUMMEPROJEKT3 = 0\r\n    SUMMEPROJEKT4 = 0\r\n    SUMMEZULAGE = 0\r\n    custom_summe_gehalt = 0\r\n\r\n    today_date = frappe.utils.getdate()  # Wandelt das heutige Datum in ein Date-Objekt um\r\n\r\n    # Erster Teil: Grundvertrag pr\u00fcfen\r\n    if doc.custom_grundvertrag_in_verhandlung:\r\n        if (doc.custom_gehalt_des_grundvertrags_in_verhandlung\r\n            and (not doc.custom_start_des_grundvertrags_in_verhandlung or today_date >= frappe.utils.getdate(doc.custom_start_des_grundvertrags_in_verhandlung))\r\n            and (not doc.custom_ende_des_arbeitsverh\u00e4ltnis_in_verhandlung or today_date <= frappe.utils.getdate(doc.custom_ende_des_arbeitsverh\u00e4ltnis_in_verhandlung))):\r\n            SUMMEGRUNDVERTRAG = doc.custom_gehalt_des_grundvertrags_in_verhandlung\r\n    else:\r\n        if (doc.custom_gehalt_des_grundvertrags\r\n            and (not doc.custom_start_des_grundvertrags or today_date >= frappe.utils.getdate(doc.custom_start_des_grundvertrags))\r\n            and (not doc.custom_ende_des_arbeitsverh\u00e4ltnis or today_date <= frappe.utils.getdate(doc.custom_ende_des_arbeitsverh\u00e4ltnis))):\r\n            SUMMEGRUNDVERTRAG = doc.custom_gehalt_des_grundvertrags\r\n\r\n    # Zweiter Teil: Projektvertr\u00e4ge pr\u00fcfen\r\n    if doc.custom_projekt_1_in_verhandlung:\r\n        if doc.custom_gehalt_projekt_1_iv and doc.custom_gehalt_projekt_1_iv > 0:\r\n            SUMMEPROJEKT1 = doc.custom_gehalt_projekt_1_iv     \r\n    else:\r\n        if doc.custom_gehalt_projekt_1 and doc.custom_gehalt_projekt_1 > 0 and (not doc.custom_start_der_1_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_1_arbeit)) \\\r\n            and (not doc.custom_befristung_des_1_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_1_vertrags)):\r\n            SUMMEPROJEKT1 = doc.custom_gehalt_projekt_1\r\n\r\n    if doc.custom_projekt_2_in_verhandlung:\r\n        if doc.custom_gehalt_projekt_2_iv and doc.custom_gehalt_projekt_2_iv > 0:\r\n            SUMMEPROJEKT2 = doc.custom_gehalt_projekt_2_iv\r\n    else:\r\n        if doc.custom_gehalt_projekt_2 and doc.custom_gehalt_projekt_2 > 0 and (not doc.custom_start_der_2_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_2_arbeit)) \\\r\n            and (not doc.custom_befristung_des_2_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_2_vertrags)):\r\n            SUMMEPROJEKT2 = doc.custom_gehalt_projekt_2\r\n\r\n    if doc.custom_projekt_3_in_verhandlung:\r\n        if doc.custom_gehalt_projekt_3_i and doc.custom_gehalt_projekt_3_iv > 0:\r\n            SUMMEPROJEKT3 = doc.custom_gehalt_projekt_3_iv\r\n    else:\r\n        if doc.custom_gehalt_projekt_3 and doc.custom_gehalt_projekt_3 > 0 and (not doc.custom_start_der_3_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_3_arbeit)) \\\r\n            and (not doc.custom_befristung_des_3_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_3_vertrags)):\r\n            SUMMEPROJEKT3 = doc.custom_gehalt_projekt_3\r\n\r\n    if doc.custom_gehalt_projekt_4 > 0 and (not doc.custom_start_der_4_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_4_arbeit)) \\\r\n        and (not doc.custom_befristung_des_4_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_4_vertrags)):\r\n        SUMMEPROJEKT4 = doc.custom_gehalt_projekt_4\r\n\r\n    # Dritter Teil: Lohnteile zusammenrechnen\r\n    projekt_sum = SUMMEPROJEKT1 + SUMMEPROJEKT2 + SUMMEPROJEKT3 + SUMMEPROJEKT4\r\n    if projekt_sum == 0: custom_summe_gehalt = SUMMEGRUNDVERTRAG\r\n\r\n    # Welche Kreuze spielen eine Rolle?\r\n    if doc.custom_projekt_1_in_verhandlung: kreuz1 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_iv\r\n    else: kreuz1 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt    \r\n    if doc.custom_projekt_2_in_verhandlung: kreuz2 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2_iv\r\n    else: kreuz2 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2    \r\n    if doc.custom_projekt_3_in_verhandlung: kreuz3 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3_iv\r\n    else: kreuz3 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3   \r\n    # Das 4. Projekt hat keine Verhandlungsoption \r\n    kreuz4 = doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_4\r\n\r\n    if projekt_sum > 0 and (not any([kreuz1,kreuz2,kreuz3,kreuz4])): \r\n        custom_summe_gehalt = projekt_sum\r\n    else:\r\n        custom_summe_gehalt = projekt_sum + SUMMEGRUNDVERTRAG\r\n\r\n    # Vierter Teil: Zulagen summieren und hinzuf\u00fcgen\r\n    if doc.custom_zulage_1_in_verhandlung:\r\n        if ((doc.custom_projekt_zulage_1_iv and doc.custom_zulage_zulage_1_iv)\r\n            and (not doc.custom_anfangsdatum_zulage_1_iv or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_1_iv))\r\n            and (not doc.custom_enddatum_zulage_1_iv or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_1_iv))):\r\n            SUMMEZULAGE = SUMMEZULAGE + doc.custom_zulage_zulage_1_iv\r\n    else:\r\n        if ((doc.custom_projekt_zulage_1 and doc.custom_zulage_zulage_1)\r\n            and (not doc.custom_anfangsdatum_zulage_1 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_1))\r\n            and (not doc.custom_enddatum_zulage_1 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_1))):\r\n            SUMMEZULAGE = SUMMEZULAGE + doc.custom_zulage_zulage_1\r\n\r\n    if doc.custom_zulage_2_in_verhandlung:\r\n        if ((doc.custom_projekt_zulage_2_iv and doc.custom_zulage_zulage_2_iv)\r\n            and (not doc.custom_anfangsdatum_zulage_2_iv or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_2_iv))\r\n            and (not doc.custom_enddatum_zulage_2_iv or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_2_iv))):\r\n            SUMMEZULAGE = SUMMEZULAGE + doc.custom_zulage_zulage_2_iv\r\n    else:\r\n        if ((doc.custom_projekt_zulage_2 and doc.custom_zulage_zulage_2)\r\n            and (not doc.custom_anfangsdatum_zulage_2 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_2))\r\n            and (not doc.custom_enddatum_zulage_2 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_2))):\r\n            SUMMEZULAGE = SUMMEZULAGE + doc.custom_zulage_zulage_2\r\n\r\n    if custom_summe_gehalt > 0:\r\n        custom_summe_gehalt = custom_summe_gehalt + SUMMEZULAGE\r\n\r\n    # Ergebnis speichern\r\n    doc.custom_summe_gehalt_bei_offener_vertragsverhandlung = custom_summe_gehalt    \r\n#    doc.custom_summe_gehalt = custom_summe_gehalt\r\n#    doc.custom_summe_gehalt_2 = custom_summe_gehalt\r\n\r\n# Funktion aufrufen\r\ncalculate_salary(doc)",
        "enable_rate_limit": 0,
        "rate_limit_count": 5,
        "rate_limit_seconds": 86400,
        "_user_tags": null,
        "_comments": null,
        "_assign": null,
        "_liked_by": "[\"Administrator\", \"l.maeurer@schmidtundtoechter.com\"]",
        "doctype": "Server Script"
    },
    {
        "name": "Mitarbeiter - Summe Wochenarbeitszeit f\u00fcr  Einzelner Datenatz",
        "idx": 4,
        "script_type": "DocType Event",
        "reference_doctype": "Employee",
        "event_frequency": "Daily",
        "cron_format": null,
        "doctype_event": "Before Save",
        "api_method": null,
        "allow_guest": 0,
        "module": "Custom",
        "disabled": 0,
        "script": "# Dieses Script wird beim Speichern eines Employee-Dokuments ausgef\u00fchrt.\r\n# Dieses Script wurde von Lars Maeurer bearbeitet und sollte funktionieren. Tests stehen teilweise noch aus.\r\n\r\ndef calculate_working_hours(doc):\r\n    # Variableninitialisierung\r\n    SUMMEGRUNDVERTRAGWAZ = 0\r\n    SUMMEPROJEKT1WAZ = 0\r\n    SUMMEPROJEKT2WAZ = 0\r\n    SUMMEPROJEKT3WAZ = 0\r\n    SUMMEPROJEKT4WAZ = 0\r\n    SUMMEZULAGEWAZ = 0\r\n    custom_summe_wochenarbeitszeit = 0\r\n\r\n    today_date = frappe.utils.getdate()  # Wandelt das heutige Datum in ein Date-Objekt um\r\n    \r\n    # Erster Teil: Grundvertrag pr\u00fcfen\r\n    if (doc.custom_wochenstunden_grundvertrag \r\n        and (not doc.custom_start_des_grundvertrags or today_date >= frappe.utils.getdate(doc.custom_start_des_grundvertrags))\r\n        and (not doc.custom_ende_des_arbeitsverh\u00e4ltnis or today_date <= frappe.utils.getdate(doc.custom_ende_des_arbeitsverh\u00e4ltnis))):\r\n        SUMMEGRUNDVERTRAGWAZ = doc.custom_wochenstunden_grundvertrag\r\n\r\n    # Zweiter Teil: Projektvertr\u00e4ge pr\u00fcfen\r\n    if doc.custom_wochenstunden_projekt_1 and (not doc.custom_start_der_1_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_1_arbeit)) \\\r\n        and (not doc.custom_befristung_des_1_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_1_vertrags)):\r\n        SUMMEPROJEKT1WAZ = doc.custom_wochenstunden_projekt_1\r\n\r\n    if doc.custom_wochenstunden_projekt_2 and (not doc.custom_start_der_2_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_2_arbeit)) \\\r\n        and (not doc.custom_befristung_des_2_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_2_vertrags)):\r\n        SUMMEPROJEKT2WAZ = doc.custom_wochenstunden_projekt_2\r\n\r\n    if doc.custom_wochenstunden_projekt_3 and (not doc.custom_start_der_3_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_3_arbeit)) \\\r\n        and (not doc.custom_befristung_des_3_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_3_vertrags)):\r\n        SUMMEPROJEKT3WAZ = doc.custom_wochenstunden_projekt_3\r\n\r\n    if doc.custom_wochenstunden_projekt_4 and (not doc.custom_start_der_4_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_4_arbeit)) \\\r\n        and (not doc.custom_befristung_des_4_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_4_vertrags)):\r\n        SUMMEPROJEKT4WAZ = doc.custom_wochenstunden_projekt_4\r\n\r\n    # Dritter Teil: Arbeitszeiten zusammenrechnen\r\n    projekt_sum = SUMMEPROJEKT1WAZ + SUMMEPROJEKT2WAZ + SUMMEPROJEKT3WAZ + SUMMEPROJEKT4WAZ\r\n\r\n    if projekt_sum > 0 and (not any([\r\n        doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen, \r\n        doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen_1, \r\n        doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen_2, \r\n        doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen_4\r\n    ])):\r\n        custom_summe_wochenarbeitszeit = projekt_sum\r\n    else:\r\n        custom_summe_wochenarbeitszeit = projekt_sum + SUMMEGRUNDVERTRAGWAZ\r\n\r\n#    if SUMMEGRUNDVERTRAGWAZ > 0:\r\n#        custom_summe_wochenarbeitszeit = SUMMEGRUNDVERTRAGWAZ\r\n#        custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT1WAZ if doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen else custom_summe_wochenarbeitszeit\r\n#        custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT2WAZ if doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen_1 else custom_summe_wochenarbeitszeit\r\n#        custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT3WAZ if doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen_2 else custom_summe_wochenarbeitszeit\r\n#        custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT4WAZ if doc.custom_wochenstunden_zum_grundvertrag_hinzurechnen_4 else custom_summe_wochenarbeitszeit\r\n\r\n    # Vierter Teil: Zulagen summieren und hinzuf\u00fcgen\r\n    if ((doc.custom_projekt_zulage_1 and doc.custom_wochenstunden_zulage_1)\r\n        and (not doc.custom_anfangsdatum_zulage_1 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_1))\r\n        and (not doc.custom_enddatum_zulage_1 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_1))):\r\n        SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + doc.custom_wochenstunden_zulage_1\r\n\r\n    if ((doc.custom_projekt_zulage_2 and doc.custom_wochenstunden_zulage_2)\r\n        and (not doc.custom_anfangsdatum_zulage_2 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_2))\r\n        and (not doc.custom_enddatum_zulage_2 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_2))):\r\n        SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + doc.custom_wochenstunden_zulage_2\r\n\r\n    if custom_summe_wochenarbeitszeit > 0:\r\n        custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEZULAGEWAZ\r\n\r\n    # Ergebnis speichern\r\n    doc.custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit\r\n    doc.custom_summe_wochenarbeitszeit_2 = custom_summe_wochenarbeitszeit\r\n\r\n# Funktion wird bei Speichern aufgerufen\r\ncalculate_working_hours(doc)\r\n\r\n",
        "enable_rate_limit": 0,
        "rate_limit_count": 5,
        "rate_limit_seconds": 86400,
        "_user_tags": null,
        "_comments": "[{\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><h3><strong>Beschreibung des Scripts:</strong></h3><p>Das Script...\", \"by\": \"Administrator\", \"name\": \"dfhdeqainr\"}]",
        "_assign": null,
        "_liked_by": "[\"l.maeurer@schmidtundtoechter.com\", \"Administrator\"]",
        "doctype": "Server Script"
    },
    {
        "name": "Mitarbeiter - Summe Lohn berechnen V2",
        "idx": 5,
        "script_type": "Scheduler Event",
        "reference_doctype": null,
        "event_frequency": "Daily",
        "cron_format": "",
        "doctype_event": "Before Insert",
        "api_method": null,
        "allow_guest": 0,
        "module": "Custom",
        "disabled": 0,
        "script": "# Dieses Script wird t\u00e4glich um 00:01 Uhr f\u00fcr alle Employee-Datens\u00e4tze ausgef\u00fchrt.\r\n# edit von Lars Maeurer - Tests stehen noch aus\r\n\r\ndef calculate_salary():\r\n    employees = frappe.get_all(\"Employee\")\r\n    today_date = frappe.utils.getdate()  # Wandelt das heutige Datum in ein Date-Objekt um\r\n    \r\n    for emp in employees:\r\n        employee = frappe.get_doc(\"Employee\", emp.name)\r\n        \r\n        # Variableninitialisierung\r\n        SUMMEGRUNDVERTRAG = 0\r\n        SUMMEPROJEKT1 = 0\r\n        SUMMEPROJEKT2 = 0\r\n        SUMMEPROJEKT3 = 0\r\n        SUMMEPROJEKT4 = 0\r\n        SUMMEZULAGE = 0\r\n        custom_summe_gehalt = 0\r\n        \r\n        # Erster Teil: Grundvertrag pr\u00fcfen\r\n        if (employee.custom_gehalt_des_grundvertrags \r\n            and (not employee.custom_start_des_grundvertrags or today_date >= frappe.utils.getdate(employee.custom_start_des_grundvertrags))\r\n            and (not employee.custom_ende_des_arbeitsverh\u00e4ltnis or today_date <= frappe.utils.getdate(employee.custom_ende_des_arbeitsverh\u00e4ltnis))):\r\n            SUMMEGRUNDVERTRAG = employee.custom_gehalt_des_grundvertrags\r\n        \r\n        # Zweiter Teil: Projektvertr\u00e4ge pr\u00fcfen\r\n        if employee.custom_gehalt_projekt_1 and (employee.custom_gehalt_projekt_1 > 0) and (not employee.custom_start_der_1_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_1_arbeit)) \\\r\n            and (not employee.custom_befristung_des_1_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_1_vertrags)):\r\n            SUMMEPROJEKT1 = employee.custom_gehalt_projekt_1\r\n\r\n        if employee.custom_gehalt_projekt_2 and (employee.custom_gehalt_projekt_2 > 0) and (not employee.custom_start_der_2_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_2_arbeit)) \\\r\n            and (not employee.custom_befristung_des_2_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_2_vertrags)):\r\n            SUMMEPROJEKT2 = employee.custom_gehalt_projekt_2\r\n\r\n        if employee.custom_gehalt_projekt_3 and (employee.custom_gehalt_projekt_3 > 0) and (not employee.custom_start_der_3_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_3_arbeit)) \\\r\n            and (not employee.custom_befristung_des_3_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_3_vertrags)):\r\n            SUMMEPROJEKT3 = employee.custom_gehalt_projekt_3\r\n\r\n        if employee.custom_gehalt_projekt_4 and (employee.custom_gehalt_projekt_4 > 0) and (not employee.custom_start_der_4_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_4_arbeit)) \\\r\n            and (not employee.custom_befristung_des_4_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_4_vertrags)):\r\n            SUMMEPROJEKT4 = employee.custom_gehalt_projekt_4\r\n\r\n        # Dritter Teil: Lohnteile zusammenrechnen\r\n        projekt_sum = SUMMEPROJEKT1 + SUMMEPROJEKT2 + SUMMEPROJEKT3 + SUMMEPROJEKT4\r\n        if projekt_sum == 0: custom_summe_gehalt = SUMMEGRUNDVERTRAG\r\n\r\n        if projekt_sum > 0 and not any([\r\n            employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt, \r\n            employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_1, \r\n            employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2, \r\n            employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3\r\n        ]):\r\n            custom_summe_gehalt = projekt_sum\r\n        else:\r\n            custom_summe_gehalt = projekt_sum + SUMMEGRUNDVERTRAG\r\n\r\n#        elif SUMMEGRUNDVERTRAG > 0:\r\n#            custom_summe_gehalt = SUMMEGRUNDVERTRAG\r\n#            custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT1 if employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt else custom_summe_gehalt\r\n#            custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT2 if employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_1 else custom_summe_gehalt\r\n#            custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT3 if employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2 else custom_summe_gehalt\r\n#            custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT4 if employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3 else custom_summe_gehalt\r\n\r\n        # Vierter Teil: Zulagen summieren und hinzuf\u00fcgen\r\n        if ((employee.custom_projekt_zulage_1 and employee.custom_zulage_zulage_1)\r\n            and (not employee.custom_anfangsdatum_zulage_1 or today_date >= frappe.utils.getdate(employee.custom_anfangsdatum_zulage_1))\r\n            and (not employee.custom_enddatum_zulage_1 or today_date <= frappe.utils.getdate(employee.custom_enddatum_zulage_1))):\r\n            SUMMEZULAGE = SUMMEZULAGE + employee.custom_zulage_zulage_1\r\n\r\n        if ((employee.custom_projekt_zulage_2 and employee.custom_zulage_zulage_2)\r\n            and (not employee.custom_anfangsdatum_zulage_2 or today_date >= frappe.utils.getdate(employee.custom_anfangsdatum_zulage_2))\r\n            and (not employee.custom_enddatum_zulage_2 or today_date <= frappe.utils.getdate(employee.custom_enddatum_zulage_2))):\r\n            SUMMEZULAGE = SUMMEZULAGE + employee.custom_zulage_zulage_2\r\n\r\n \r\n        if custom_summe_gehalt > 0:\r\n            custom_summe_gehalt = custom_summe_gehalt + SUMMEZULAGE\r\n\r\n        # F\u00fcnfter Teil: custom_summe_gehalt anzeigen\r\n        employee.custom_summe_gehalt = custom_summe_gehalt\r\n        employee.custom_summe_gehalt_2 = custom_summe_gehalt\r\n        \r\n        # Speichern der Ergebnisse - ist das n\u00f6tig? - vermutlich schon, weil wir nicht auf einem bestimmten doc agieren mit unserem Script (?!!!)\r\n        employee.save(ignore_permissions=True)\r\n\r\n# Aufruf der Funktion f\u00fcr t\u00e4gliche Berechnung\r\ncalculate_salary()",
        "enable_rate_limit": 0,
        "rate_limit_count": 5,
        "rate_limit_seconds": 86400,
        "_user_tags": null,
        "_comments": "[{\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>Konzept:</p><p><br></p><p>Ziel ist es, f\\u00fcr alle Employees in ...\", \"by\": \"Administrator\", \"name\": \"ocnpef1309\"}, {\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>Erweiterung Vierter Teil:</p><p><br></p><p>Vierter Teil: Zula...\", \"by\": \"Administrator\", \"name\": \"p442issbea\"}, {\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>Logik wurde auch auf andere Enddaten angewendet. Wenn kein Ve...\", \"by\": \"Administrator\", \"name\": \"peikllj63j\"}, {\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>TESTS WAREN OK</p></div>\", \"by\": \"Administrator\", \"name\": \"kdl2l1co4u\"}]",
        "_assign": null,
        "_liked_by": "[\"l.maeurer@schmidtundtoechter.com\", \"Administrator\"]",
        "doctype": "Server Script"
    },
    {
        "name": "Mitarbeiter - Gesamtlohn des gerade bearbeiteten MA berechnen",
        "idx": 5,
        "script_type": "DocType Event",
        "reference_doctype": "Employee",
        "event_frequency": "All",
        "cron_format": null,
        "doctype_event": "Before Save",
        "api_method": null,
        "allow_guest": 0,
        "module": "Custom",
        "disabled": 0,
        "script": "# Dieses Script wird beim Speichern eines Employee-Dokuments ausgef\u00fchrt.\r\n# Dieses Script wurde von Lars Maeurer bearbeitet und sollte funktionieren. Tests stehen teilweise noch aus.\r\n\r\ndef calculate_salary(doc):\r\n    # Variableninitialisierung\r\n    SUMMEGRUNDVERTRAG = 0\r\n    SUMMEPROJEKT1 = 0\r\n    SUMMEPROJEKT2 = 0\r\n    SUMMEPROJEKT3 = 0\r\n    SUMMEPROJEKT4 = 0\r\n    SUMMEZULAGE = 0\r\n    custom_summe_gehalt = 0\r\n\r\n    today_date = frappe.utils.getdate()  # Wandelt das heutige Datum in ein Date-Objekt um\r\n\r\n    # Erster Teil: Grundvertrag pr\u00fcfen\r\n    if (doc.custom_gehalt_des_grundvertrags\r\n        and (not doc.custom_start_des_grundvertrags or today_date >= frappe.utils.getdate(doc.custom_start_des_grundvertrags))\r\n        and (not doc.custom_ende_des_arbeitsverh\u00e4ltnis or today_date <= frappe.utils.getdate(doc.custom_ende_des_arbeitsverh\u00e4ltnis))):\r\n        SUMMEGRUNDVERTRAG = doc.custom_gehalt_des_grundvertrags\r\n\r\n    # Zweiter Teil: Projektvertr\u00e4ge pr\u00fcfen\r\n    if doc.custom_gehalt_projekt_1 and doc.custom_gehalt_projekt_1 > 0 and (not doc.custom_start_der_1_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_1_arbeit)) \\\r\n        and (not doc.custom_befristung_des_1_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_1_vertrags)):\r\n        SUMMEPROJEKT1 = doc.custom_gehalt_projekt_1\r\n\r\n    if doc.custom_gehalt_projekt_2 and doc.custom_gehalt_projekt_2 > 0 and (not doc.custom_start_der_2_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_2_arbeit)) \\\r\n        and (not doc.custom_befristung_des_2_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_2_vertrags)):\r\n        SUMMEPROJEKT2 = doc.custom_gehalt_projekt_2\r\n\r\n    if doc.custom_gehalt_projekt_3 and doc.custom_gehalt_projekt_3 > 0 and (not doc.custom_start_der_3_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_3_arbeit)) \\\r\n        and (not doc.custom_befristung_des_3_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_3_vertrags)):\r\n        SUMMEPROJEKT3 = doc.custom_gehalt_projekt_3\r\n\r\n    if doc.custom_gehalt_projekt_4 and doc.custom_gehalt_projekt_4 > 0 and (not doc.custom_start_der_4_arbeit or today_date >= frappe.utils.getdate(doc.custom_start_der_4_arbeit)) \\\r\n        and (not doc.custom_befristung_des_4_vertrags or today_date <= frappe.utils.getdate(doc.custom_befristung_des_4_vertrags)):\r\n        SUMMEPROJEKT4 = doc.custom_gehalt_projekt_4\r\n\r\n    # Dritter Teil: Lohnteile zusammenrechnen\r\n    projekt_sum = SUMMEPROJEKT1 + SUMMEPROJEKT2 + SUMMEPROJEKT3 + SUMMEPROJEKT4\r\n    if projekt_sum == 0: custom_summe_gehalt = SUMMEGRUNDVERTRAG\r\n\r\n    \r\n    if projekt_sum > 0 and (not any([\r\n        doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt, \r\n        doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_1, \r\n        doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2, \r\n        doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3\r\n    ])):\r\n        custom_summe_gehalt = projekt_sum\r\n    else:\r\n        custom_summe_gehalt = projekt_sum + SUMMEGRUNDVERTRAG\r\n\r\n#    elif SUMMEGRUNDVERTRAG > 0:\r\n#        custom_summe_gehalt = SUMMEGRUNDVERTRAG\r\n#        custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT1 if doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt else custom_summe_gehalt\r\n#        custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT2 if doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_1 else custom_summe_gehalt\r\n#        custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT3 if doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2 else custom_summe_gehalt\r\n#        custom_summe_gehalt = custom_summe_gehalt + SUMMEPROJEKT4 if doc.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3 else custom_summe_gehalt\r\n\r\n    # Vierter Teil: Zulagen summieren und hinzuf\u00fcgen\r\n    if ((doc.custom_projekt_zulage_1 and doc.custom_zulage_zulage_1)\r\n        and (not doc.custom_anfangsdatum_zulage_1 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_1))\r\n        and (not doc.custom_enddatum_zulage_1 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_1))):\r\n        SUMMEZULAGE = SUMMEZULAGE + doc.custom_zulage_zulage_1\r\n\r\n    if ((doc.custom_projekt_zulage_2 and doc.custom_zulage_zulage_2)\r\n        and (not doc.custom_anfangsdatum_zulage_2 or today_date >= frappe.utils.getdate(doc.custom_anfangsdatum_zulage_2))\r\n        and (not doc.custom_enddatum_zulage_2 or today_date <= frappe.utils.getdate(doc.custom_enddatum_zulage_2))):\r\n        SUMMEZULAGE = SUMMEZULAGE + doc.custom_zulage_zulage_2\r\n\r\n    if custom_summe_gehalt > 0:\r\n        custom_summe_gehalt = custom_summe_gehalt + SUMMEZULAGE\r\n\r\n    # Ergebnis speichern\r\n    doc.custom_summe_gehalt = custom_summe_gehalt\r\n    doc.custom_summe_gehalt_2 = custom_summe_gehalt\r\n\r\n# Funktion aufrufen\r\ncalculate_salary(doc)",
        "enable_rate_limit": 0,
        "rate_limit_count": 5,
        "rate_limit_seconds": 86400,
        "_user_tags": null,
        "_comments": "[{\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>Das Script berechnet das gesamte Gehalt eines einzelnen <stro...\", \"by\": \"Administrator\", \"name\": \"dphe0dtb9s\"}, {\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>TESTS BISHER ERFOLGREICH</p></div>\", \"by\": \"Administrator\", \"name\": \"qoqicq4np3\"}, {\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p>NEUER BUG - aktuell ausgeschaltet</p></div>\", \"by\": \"Administrator\", \"name\": \"7k18727tuh\"}]",
        "_assign": null,
        "_liked_by": "[\"l.maeurer@schmidtundtoechter.com\", \"Administrator\"]",
        "doctype": "Server Script"
    },
    {
        "name": "Mitarbeiter - Wochenarbeitsstunden berechnen",
        "idx": 4,
        "script_type": "Scheduler Event",
        "reference_doctype": "Employee",
        "event_frequency": "Daily",
        "cron_format": null,
        "doctype_event": "Before Insert",
        "api_method": null,
        "allow_guest": 0,
        "module": "Custom",
        "disabled": 0,
        "script": "# Dieses Script wird t\u00e4glich um 00:01 Uhr f\u00fcr alle Employee-Datens\u00e4tze ausgef\u00fchrt.\r\n# edit von Lars Maeurer bearbeitet und sollte funktionieren. Tests stehen teilweise noch aus.\r\n\r\ndef calculate_working_hours():\r\n    employees = frappe.get_all(\"Employee\")\r\n    today_date = frappe.utils.getdate()  # Wandelt das heutige Datum in ein Date-Objekt um\r\n    \r\n    for emp in employees:\r\n        employee = frappe.get_doc(\"Employee\", emp.name)\r\n        \r\n        # Variableninitialisierung\r\n        SUMMEGRUNDVERTRAGWAZ = 0\r\n        SUMMEPROJEKT1WAZ = 0\r\n        SUMMEPROJEKT2WAZ = 0\r\n        SUMMEPROJEKT3WAZ = 0\r\n        SUMMEPROJEKT4WAZ = 0\r\n        SUMMEZULAGEWAZ = 0\r\n        custom_summe_wochenarbeitszeit = 0\r\n        \r\n        # Erster Teil: Grundvertrag pr\u00fcfen\r\n        if (employee.custom_wochenstunden_grundvertrag \r\n            and (not employee.custom_start_des_grundvertrags or today_date >= frappe.utils.getdate(employee.custom_start_des_grundvertrags))\r\n            and (not employee.custom_ende_des_arbeitsverh\u00e4ltnis or today_date <= frappe.utils.getdate(employee.custom_ende_des_arbeitsverh\u00e4ltnis))):\r\n            SUMMEGRUNDVERTRAGWAZ = employee.custom_wochenstunden_grundvertrag\r\n        \r\n        # Zweiter Teil: Projektvertr\u00e4ge pr\u00fcfen\r\n        if employee.custom_wochenstunden_projekt_1 and (not employee.custom_start_der_1_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_1_arbeit)) \\\r\n            and (not employee.custom_befristung_des_1_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_1_vertrags)):\r\n            SUMMEPROJEKT1WAZ = employee.custom_wochenstunden_projekt_1\r\n\r\n        if employee.custom_wochenstunden_projekt_2 and (not employee.custom_start_der_2_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_2_arbeit)) \\\r\n            and (not employee.custom_befristung_des_2_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_2_vertrags)):\r\n            SUMMEPROJEKT2WAZ = employee.custom_wochenstunden_projekt_2\r\n\r\n        if employee.custom_wochenstunden_projekt_3 and (not employee.custom_start_der_3_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_3_arbeit)) \\\r\n            and (not employee.custom_befristung_des_3_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_3_vertrags)):\r\n            SUMMEPROJEKT3WAZ = employee.custom_wochenstunden_projekt_3\r\n\r\n        if employee.custom_wochenstunden_projekt_4 and (not employee.custom_start_der_4_arbeit or today_date >= frappe.utils.getdate(employee.custom_start_der_4_arbeit)) \\\r\n            and (not employee.custom_befristung_des_4_vertrags or today_date <= frappe.utils.getdate(employee.custom_befristung_des_4_vertrags)):\r\n            SUMMEPROJEKT4WAZ = employee.custom_wochenstunden_projekt_4\r\n\r\n        # Dritter Teil: Arbeitszeiten zusammenrechnen\r\n        projekt_sum = SUMMEPROJEKT1WAZ + SUMMEPROJEKT2WAZ + SUMMEPROJEKT3WAZ + SUMMEPROJEKT4WAZ\r\n\r\n        if projekt_sum > 0 and not any([\r\n            employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen, \r\n            employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen_1, \r\n            employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen_2, \r\n            employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen_4\r\n        ]):\r\n            custom_summe_wochenarbeitszeit = projekt_sum\r\n        else:\r\n            custom_summe_wochenarbeitszeit = projekt_sum + SUMMEGRUNDVERTRAGWAZ\r\n\r\n#        elif SUMMEGRUNDVERTRAGWAZ > 0:\r\n#            custom_summe_wochenarbeitszeit = SUMMEGRUNDVERTRAGWAZ\r\n#            custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT1WAZ if employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen else custom_summe_wochenarbeitszeit\r\n#            custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT2WAZ if employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen_1 else custom_summe_wochenarbeitszeit\r\n#            custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT3WAZ if employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen_2 else custom_summe_wochenarbeitszeit\r\n#            custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEPROJEKT4WAZ if employee.custom_wochenstunden_zum_grundvertrag_hinzurechnen_4 else custom_summe_wochenarbeitszeit\r\n\r\n        # Vierter Teil: Zulagen summieren und hinzuf\u00fcgen\r\n    if ((employee.custom_projekt_zulage_1 and employee.custom_wochenstunden_zulage_1)\r\n        and (not employee.custom_anfangsdatum_zulage_1 or today_date >= frappe.utils.getdate(employee.custom_anfangsdatum_zulage_1))\r\n        and (not employee.custom_enddatum_zulage_1 or today_date <= frappe.utils.getdate(employee.custom_enddatum_zulage_1))):\r\n        SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + employee.custom_wochenstunden_zulage_1\r\n\r\n    if ((employee.custom_projekt_zulage_2 and employee.custom_wochenstunden_zulage_2)\r\n        and (not employee.custom_anfangsdatum_zulage_2 or today_date >= frappe.utils.getdate(employee.custom_anfangsdatum_zulage_2))\r\n        and (not employee.custom_enddatum_zulage_2 or today_date <= frappe.utils.getdate(employee.custom_enddatum_zulage_2))):\r\n        SUMMEZULAGEWAZ = SUMMEZULAGEWAZ + employee.custom_wochenstunden_zulage_2\r\n\r\n        if custom_summe_wochenarbeitszeit > 0:\r\n            custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit + SUMMEZULAGEWAZ\r\n\r\n        # F\u00fcnfter Teil: custom_summe_wochenarbeitszeit anzeigen\r\n        employee.custom_summe_wochenarbeitszeit = custom_summe_wochenarbeitszeit\r\n        employee.custom_summe_wochenarbeitszeit_2 = custom_summe_wochenarbeitszeit\r\n        \r\n        # Speichern der Ergebnisse\r\n        employee.save(ignore_permissions=True)\r\n\r\n# Aufruf der Funktion f\u00fcr t\u00e4gliche Berechnung\r\ncalculate_working_hours()\r\n",
        "enable_rate_limit": 0,
        "rate_limit_count": 5,
        "rate_limit_seconds": 86400,
        "_user_tags": null,
        "_comments": "[{\"comment\": \"<div class=\\\"ql-editor read-mode\\\"><p><br></p><h3>Beschreibung des Scripts: <strong>Wochenarbeitsze...\", \"by\": \"Administrator\", \"name\": \"dc912dpboj\"}]",
        "_assign": null,
        "_liked_by": "[\"l.maeurer@schmidtundtoechter.com\", \"Administrator\"]",
        "doctype": "Server Script"
    },
    {
        "name": "Mitarbeiter - T\u00e4gliche Aktualisierung Summe Gehalt",
        "idx": 2,
        "script_type": "Scheduler Event",
        "reference_doctype": "Employee",
        "event_frequency": "Daily",
        "cron_format": null,
        "doctype_event": "Before Insert",
        "api_method": null,
        "allow_guest": 0,
        "module": "Custom",
        "disabled": 1,
        "script": "def calculate_custom_summe_gehalt(employee):\r\n    summe_gehalt = 0\r\n    today = frappe.utils.getdate(frappe.utils.nowdate())  # Heutiges Datum im Date-Format\r\n\r\n    # \u00dcberpr\u00fcfen, ob das Grundgehalt g\u00fcltig ist\r\n    has_valid_base_salary = False\r\n    if employee.custom_gehalt_des_grundvertrags and employee.custom_gehalt_des_grundvertrags > 0:\r\n        start_date = frappe.utils.getdate(employee.custom_start_des_grundvertrags)\r\n        end_date = frappe.utils.getdate(employee.custom_ende_des_arbeitsverh\u00e4ltnis) if employee.custom_ende_des_arbeitsverh\u00e4ltnis else None\r\n\r\n        if start_date <= today and (not end_date or end_date >= today):\r\n            additional_salary = employee.custom_gehalt_des_grundvertrags\r\n            summe_gehalt = summe_gehalt + additional_salary  # Keine Kurzoperation\r\n            has_valid_base_salary = True\r\n\r\n    # \u00dcberpr\u00fcfen der Projektgeh\u00e4lter\r\n    project_salaries = [\r\n        {\"salary\": employee.custom_gehalt_projekt_1, \"start\": employee.custom_start_der_1_arbeit, \"end\": employee.custom_befristung_des_1_vertrags, \"go\": employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt},\r\n        {\"salary\": employee.custom_gehalt_projekt_2, \"start\": employee.custom_start_der_2_arbeit, \"end\": employee.custom_befristung_des_2_vertrags, \"go\": employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_1},\r\n        {\"salary\": employee.custom_gehalt_projekt_3, \"start\": employee.custom_start_der_3_arbeit, \"end\": employee.custom_befristung_des_3_vertrags, \"go\": employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_2},\r\n        {\"salary\": employee.custom_gehalt_projekt_4, \"start\": employee.custom_start_der_4_arbeit, \"end\": employee.custom_befristung_des_4_vertrags, \"go\": employee.custom_ist_zus\u00e4tzliche_verg\u00fctung_zum_grundgehalt_3}\r\n    ]\r\n\r\n    for project in project_salaries:\r\n        if (project[\"go\"] or not has_valid_base_salary) and project[\"start\"] and project[\"salary\"] and project[\"salary\"] > 0:\r\n            start_date = frappe.utils.getdate(project[\"start\"])\r\n            end_date = frappe.utils.getdate(project[\"end\"]) if project[\"end\"] else None\r\n\r\n            if start_date <= today and (not end_date or end_date >= today):\r\n                additional_salary = project[\"salary\"]\r\n                summe_gehalt = summe_gehalt + additional_salary  # Keine Kurzoperation\r\n\r\n    return summe_gehalt\r\n\r\n# Anwendungslogik, um das berechnete Gehalt zu speichern\r\nemployees = frappe.get_all(\"Employee\", filters={}, fields=[\"name\"])\r\nfor emp in employees:\r\n    employee = frappe.get_doc(\"Employee\", emp[\"name\"])\r\n    summe_gehalt = calculate_custom_summe_gehalt(employee)\r\n    employee.custom_summe_gehalt = summe_gehalt\r\n    employee.save(ignore_permissions=True)",
        "enable_rate_limit": 0,
        "rate_limit_count": 5,
        "rate_limit_seconds": 86400,
        "_user_tags": null,
        "_comments": null,
        "_assign": null,
        "_liked_by": null,
        "doctype": "Server Script"
    }
]